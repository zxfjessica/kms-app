(function(c){function O(){if(B){z||C();var a={name:B,segment:z};c.add_event({key:"[CLY]_view",dur:l()-D,segmentation:a});B=null}}function r(a){if(!c.ignore_bots||!P)if(!c.app_key||!c.device_id)m("app_key or device_id is missing");else{a.app_key=c.app_key;a.device_id=c.device_id;a.sdk_name=$;c.country_code&&(a.country_code=c.country_code);c.city&&(a.city=c.city);null!==c.ip_address&&(a.ip_address=c.ip_address);a.timestamp=l();var b=new Date;a.hour=b.getHours();a.dow=b.getDay();s.length>H&&s.shift();
s.push(a);q("cly_queue",s,!0)}}function I(){if("undefined"!==typeof c.q&&0<c.q.length){for(var a,b=0;b<c.q.length;b++)if(a=c.q[b],m("Processing queued call",a),"function"===typeof a)a();else if(a.constructor===Array&&0<a.length)if("undefined"!==typeof c[a[0]])c[a[0]].apply(null,a.slice(1));else{var f=a[0].replace("userData.","");"undefined"!==typeof c.userData[f]&&c.userData[f].apply(null,a.slice(1))}c.q=[]}x&&(Q&&A)&&(a=l(),60<a-w&&(c.session_duration(a-w),w=a));0<t.length&&(10>=t.length?(r({events:JSON.stringify(t)}),
t=[]):(a=t.splice(0,10),r({events:JSON.stringify(a)})),q("cly_event",t));if(0<s.length&&J&&l()>R){J=!1;var e=s.shift();m("Processing request",e);var i=function(a,b){m("Request Finished",b,a);a&&(s.unshift(b),R=l()+K);q("cly_queue",s,!0);J=!0};try{m("Sending XML HTTP request");var h=window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null;h.open("GET",c.url+aa+"?"+ba(e),!0);h.onreadystatechange=function(){4===this.readyState&&200<=this.status&&
300>this.status?"function"===typeof i&&i(!1,e):4===this.readyState&&(m("Failed Server XML HTTP request",this.status),"function"===typeof i&&i(!0,e))};h.send()}catch(j){m("Failed XML HTTP request",j),"function"===typeof i&&i(!0,e)}}setTimeout(I,L)}function C(){var a={};a._app_version=c.app_version;screen.width&&(a._resolution=""+(screen.width?screen.width:"")+"x"+(screen.height?screen.height:""));for(var b=navigator.appVersion,f=navigator.userAgent,e=navigator.appName,i,h,j=[["Opera Mini","Opera Mini"],
["Opera","Opera"],["OPR","Opera"],["MSIE","Internet Explorer"],["IEMobile","IE Mobile"],["Edge","Edge"],["CrKey","Chromecast"],["Chromium","Chromium"],["FxiOS","Firefox"],["Trident","Internet Explorer"],["FBAV/","Facebook app"],["baiduboxapp/","Baidu Box App"],["baidubrowser/","Baidu Browser"],["Dolfin","Dolfin"],["Skyfire","Skyfire"],["bolt","Bolt"],["teashark","TeaShark"],["Blazer","Blazer"],["Tizen","Tizen"],["UCWEB","UCBrowser"],["UC.","UCBrowser"],["DiigoBrowser","DiigoBrowser"],["Puffin","Puffin"],
["Mercury","Mercury"],["Obigo","ObigoBrowser"],["NF-Browser","NetFront"],["amaya","Amaya"],["Arora","Arora"],["Avant","Avant"],["BlackBerry","BlackBerry"],["RIM","BlackBerry"],["CFNetwork","CFNetwork"],["Camino","Camino"],["Coast","Coast"],["Dalvik","Dalvik"],["Dillo","Dillo"],["DoCoMo","DoCoMo"],["ELinks","ELinks"],["Espial","Espial TV Browser"],["FlyFlow","FlyFlow"],["GSA","Google App"],["Google Desktop","Google Desktop"],["GooglePlus","Google+ App"],["IBrowse","IBrowse"],["Jasmine","Jasmine"],
["Kindle","Kindle"],["Konqueror","Konqueror"],["Links","Links"],["Lotus-Notes","Lotus Notes"],["Lynx","Lynx"],["WAP","WAP Browser"],["MiuiBrowser","Miui Browser"],["Nokia","Nokia"],["OneBrowser","OneBrowser"],["Outlook","Outlook"],["Palm","Palm"],["Pinterest","Pinterest App"],["Playstation","Playstation"],["PlayStation","Playstation"],["PLAYSTATION","Playstation"],["Polaris","Polaris"],["QQ","QQbrowser"],["Qt","Qt"],["QuickTime","QuickTime"],["SEMC-Browser","SEMC Browser"],["SamsungBrowser","Samsung Browser"],
["SeaMonkey","SeaMonkey"],["Sleipnir","Sleipnir"],["SmartTV","SmartTV WebBrowser"],["Viera","SmartViera"],["Thunderbird","Thunderbird"],["Vivaldi","Vivaldi"],["wOSBrowser","webOS"],["WebTV","WebTV"],["wp-","WordPress App"],["YaBrowser","Yandex Browser"],["iCab","iCab"],["iTunes","iTunes"],["rekonq","rekonq"],["rekonq","rekonq"],["Chrome","Chrome"],["Firefox","Firefox"],["Android","Android"],["Safari","Safari"],["iPhone","Safari"]],g=0;g<j.length;g++)if(-1!=f.indexOf(j[g][0])){e=j[g][1];break}if(!e&&
(i=f.lastIndexOf(" ")+1)<(h=f.lastIndexOf("/")))e=f.substring(i,h),e.toLowerCase()==e.toUpperCase()&&(e=navigator.appName);a._browser=e;e="unknown";i=[{s:"Xbox",r:/Xbox/},{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},
{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 10",r:/(Windows NT 10.0)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Windows Phone",r:/Windows Phone/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OSX",
r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"SearchBot",r:S}];for(var d in i)if(h=i[d],h.r.test(f)){e=h.s;break}d="unknown";/Windows/.test(e)&&"Windows Phone"!=e&&(d=/Windows (.*)/.exec(e)[1],e="Windows");switch(e){case "Mac OSX":d=/Mac OS X (10[\.\_\d]+)/.exec(f)[1];break;case "Windows Phone":d=(/Windows Phone ([\.\_\d]+)/.exec(f)||["","8.0"])[1];break;case "Android":d=/Android ([\.\_\d]+)/.exec(f)[1];
break;case "iOS":d=/OS (\d+)_(\d+)_?(\d+)?/.exec(b),d=d[1]+"."+d[2]+"."+(d[3]|0)}z=a._os=e;a._os_version=d;b=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;"undefined"!==typeof b&&(a._locale=b);if("undefined"!==typeof document.referrer&&document.referrer.length&&(b=T.exec(document.referrer))&&b[11]&&b[11]!=window.location.hostname)a._store=document.referrer;m("Got metrics",a);return a}function m(){c.debug&&"undefined"!==typeof console&&(arguments[1]&&
"object"==typeof arguments[1]&&(arguments[1]=JSON.stringify(arguments[1])),console.log(Array.prototype.slice.call(arguments).join("\n")))}function l(){return Math.floor((new Date).getTime()/1E3)}function M(a,b,c){var c=c||U,e="";"object"===typeof a?"undefined"!==typeof a.stack?e=a.stack:("undefined"!==typeof a.name&&(e+=a.name+":"),"undefined"!==typeof a.message&&(e+=a.message+"\n"),"undefined"!==typeof a.fileName&&(e+="in "+a.fileName+"\n"),"undefined"!==typeof a.lineNumber&&(e+="on "+a.lineNumber),
"undefined"!==typeof a.columnNumber&&(e+=":"+a.columnNumber)):e=a+"";var b=b?!0:!1,a=C(),e={_os:a._os,_os_version:a._os_version,_resolution:a._resolution,_error:e,_app_version:a._app_version,_run:l()-V,_not_os_specific:!0},i=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery;i&&(e._bat=Math.floor(100*i.level));"undefined"!==typeof navigator.onLine&&(e._online=navigator.onLine?!0:!1);e._background=document.hasFocus()?!1:!0;0<E.length&&(e._logs=E.join("\n"));E=[];
e._nonfatal=b;e._view=(window.location.pathname||"")+(window.location.search||"")+(window.location.hash||"");e._browser=a._browser;"undefined"!==typeof c&&(e._custom=c);try{var h=document.createElement("canvas").getContext("experimental-webgl");e._opengl=h.getParameter(h.VERSION)}catch(j){}r({crash:JSON.stringify(e)})}function ba(a){var b=[],c;for(c in a)b.push(c+"="+encodeURIComponent(a[c]));return b.join("&")}function W(a,b){for(var c={},e,i=0;i<b.length;i++)e=b[i],"undefined"!==typeof a[e]&&(c[e]=
a[e]);return c}function X(a){"undefined"==typeof a.pageY&&("number"==typeof a.clientX&&document.documentElement)&&(a.pageX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a.pageY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return a}var $="javascript_native_web",Y=!1,x=!1,aa="/i",L=500,H=1E3,s=[],t=[],E=[],y={},U=null,Q=!0,w,Z=0,B=null,D=0,N=0,R=0,K=60,F=20,G=0,J=!0,z,T=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,
S=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO)/,P=!1,A=!0,V;c.init=function(a){if(!Y){V=l();Y=!0;s=q("cly_queue")||
[];y={};t=q("cly_event")||[];a=a||{};L=a.interval||c.interval||L;H=a.queue_size||c.queue_size||H;K=a.fail_timeout||c.fail_timeout||K;F=a.inactivity_time||c.inactivity_time||F;c.debug=a.debug||c.debug||!1;c.app_key=a.app_key||c.app_key||null;var b=c,f;if(!(f=a.device_id))if(!(f=c.device_id))if(!(f=q("cly_id"))){var e=(new Date).getTime();f="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=(e+16*Math.random())%16|0;e=Math.floor(e/16);return("x"==a?b:b&3|8).toString(16)})}b.device_id=
f;b=c;f=a.url||c.url||"https://cloud.count.ly";f="/"==f.substr(f.length-1)?f.substr(0,f.length-1):f;b.url=f;c.app_version=a.app_version||c.app_version||"0.0";c.country_code=a.country_code||c.country_code||null;c.city=a.city||c.city||null;c.ip_address=a.ip_address||c.ip_address||null;c.ignore_bots=a.ignore_bots||c.ignore_bots||!0;c.q=c.q||[];m("Countly initialized");S.test(navigator.userAgent)&&(P=!0);c.q.constructor!==Array&&(c.q=[]);I();q("cly_id",c.device_id);if(location.search){a=location.search.substring(1).split("&");
for(b=0;b<a.length;b++)f=a[b].split("="),"cly_id"==f[0]?q("cly_cmp_id",f[1]):"cly_uid"==f[0]&&q("cly_cmp_uid",f[1])}}};c.begin_session=function(a){x||(m("Session started"),w=l(),x=!0,Q=a?!1:!0,a={begin_session:1},a.metrics=JSON.stringify(C()),r(a))};c.session_duration=function(a){x&&(m("Session extended",a),r({session_duration:a}))};c.end_session=function(a){x&&(a=a||l()-w,m("Ending session"),O(),x=!1,r({end_session:1,session_duration:a}),I())};c.change_id=function(a,b){if(c.device_id!=a){var f=c.device_id;
c.device_id=a;q("cly_id",c.device_id);m("Changing id");b&&r({old_device_id:f})}};c.add_event=function(a){if(a.key){a.count||(a.count=1);var b=W(a,["key","count","sum","dur","segmentation"]);b.timestamp=l();var c=new Date;b.hour=c.getHours();b.dow=c.getDay();t.push(b);q("cly_event",t);m("Adding event: ",a)}else m("Event must have key property")};c.start_event=function(a){y[a]?m("Timed event with key "+a+" already started"):y[a]=l()};c.end_event=function(a){"string"==typeof a&&(a={key:a});a.key?y[a.key]?
(a.dur=l()-y[a.key],c.add_event(a),delete y[a.key]):m("Timed event with key "+key+" was not started"):m("Event must have key property")};c.user_details=function(a){m("Adding userdetails: ",a);r({user_details:JSON.stringify(W(a,"name username email organization phone picture gender byear custom".split(" ")))})};c.report_conversion=function(a,b){a=a||q("cly_cmp_id")||"cly_organic";b=b||q("cly_cmp_uid");a&&b?r({campaign_id:a,campaign_user:b}):a?r({campaign_id:a}):m("No campaign data found")};var u={},
v=function(a,b,c){u[a]||(u[a]={});"$push"==c||"$pull"==c||"$addToSet"==c?(u[a][c]||(u[a][c]=[]),u[a][c].push(b)):u[a][c]=b};c.userData={set:function(a,b){u[a]=b},set_once:function(a){v(a,1,"$setOnce")},increment:function(a){v(a,1,"$inc")},increment_by:function(a,b){v(a,b,"$inc")},multiply:function(a,b){v(a,b,"$mul")},max:function(a,b){v(a,b,"$max")},min:function(a,b){v(a,b,"$min")},push:function(a,b){v(a,b,"$push")},push_unique:function(a,b){v(a,b,"$addToSet")},pull:function(a,b){v(a,b,"$pull")},
save:function(){r({user_details:JSON.stringify({custom:u})});u={}}};c.track_errors=function(a){U=a;window.onerror=function(a,c,e,i,h){if("undefined"!==typeof h)M(h,!1);else{var i=i||window.event&&window.event.errorCharacter,j="";"undefined"!==typeof a&&(j+=a+"\n");"undefined"!==typeof c&&(j+="at "+c);"undefined"!==typeof e&&(j+=":"+e);"undefined"!==typeof i&&(j+=":"+i);j+="\n";try{for(var g=[],d=arguments.callee.caller;d;)g.push(d.name),d=d.caller;j+=g.join("\n")}catch(m){}M(j,!1)}}};c.log_error=
function(a,b){M(a,!0,b)};c.add_log=function(a){E.push(a)};c.stop_time=function(){A&&(A=!1,Z=l()-w,N=l()-D)};c.start_time=function(){A||(A=!0,w=l()-Z,D=l()-N,N=0)};c.track_sessions=function(){function a(){document[f]?c.stop_time():c.start_time()}function b(){G>=F&&c.start_time();G=0}c.begin_session();c.start_time();k(window,"beforeunload",function(){c.end_session()});k(window,"unload",function(){c.end_session()});var f="hidden";f in document?document.addEventListener("visibilitychange",a):(f="mozHidden")in
document?document.addEventListener("mozvisibilitychange",a):(f="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(f="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?(k(window,"focusin",function(){c.start_time()}),k(window,"focusout",function(){c.stop_time()})):(k(window,"focus",function(){c.start_time()}),k(window,"blur",function(){c.stop_time()}),k(window,"pageshow",function(){c.start_time()}),k(window,"pagehide",function(){c.stop_time()}));
k(window,"mousemove",b);k(window,"click",b);k(window,"keydown",b);k(window,"scroll",b);setInterval(function(){G++;G>=F&&c.stop_time()},6E4)};c.track_pageview=function(a,b){O();a&&a.constructor===Array&&(b=a,a=null);a=a||window.location.pathname;if(b&&b.length)for(var f=0;f<b.length;f++)try{if(RegExp(b[f]).test(a)){m("Ignored:",a);return}}catch(e){}B=a;D=l();z||C();f={name:a,visit:1,segment:z,domain:window.location.hostname};if("undefined"!==typeof document.referrer&&document.referrer.length){var i=
T.exec(document.referrer);i&&(i[11]&&i[11]!=window.location.hostname)&&(f.start=1)}c.add_event({key:"[CLY]_view",segmentation:f})};c.track_view=function(a,b){c.track_pageview(a,b)};c.track_clicks=function(a){function b(a){if(f){f=!1;X(a);if("undefined"!==typeof a.pageX&&"undefined"!==typeof a.pageY){var b;b=document;b=Math.max(Math.max(b.body.scrollHeight,b.documentElement.scrollHeight),Math.max(b.body.offsetHeight,b.documentElement.offsetHeight),Math.max(b.body.clientHeight,b.documentElement.clientHeight));
var h;h=document;h=Math.max(Math.max(h.body.scrollWidth,h.documentElement.scrollWidth),Math.max(h.body.offsetWidth,h.documentElement.offsetWidth),Math.max(h.body.clientWidth,h.documentElement.clientWidth));c.add_event({key:"[CLY]_action",segmentation:{type:"click",x:a.pageX,y:a.pageY,width:h,height:b,domain:window.location.hostname}})}setTimeout(function(){f=!0},1E3)}}var a=a||document,f=!0;k(a,"mousedown",b);k(a,"mouseup",b);k(a,"click",b)};c.track_links=function(a){function b(){function b(a){var e;
e=a?"undefined"!==typeof a.target?a.target:a.srcElement:window.event.srcElement;X(a);c.add_event({key:"linkClick",segmentation:{href:e.href,text:e.innerText,id:e.id,x:a.pageX,y:a.pageY}});"undefined"!==typeof e.href&&"_blank"!==e.target&&!a.metaKey&&!a.altKey&&!a.ctrlKey&&!a.shiftKey&&0!==e.href.replace(window.location.href.split("#")[0],"").indexOf("#")&&c.end_session()}if("undefined"!==typeof a.getElementsByTagName)for(var e=a.getElementsByTagName("a"),i=0;i<e.length;i++)k(e[i],"click",b);else m("Can't track clicks")}
a=a||document;"complete"===document.readyState?b():k(window,"load",b)};c.track_forms=function(a){function b(a){return a.name||a.id||a.type||a.nodeName}function f(a){var e=!1;k(a,"submit",function(){if(!e){e=!0;var f={id:a.id,name:a.name,action:a.action,method:a.method},g;if("undefined"!==typeof a.elements)for(var d=0;d<a.elements.length;d++)if((g=a.elements[d])&&"password"!=g.type)if("undefined"===typeof f["input:"+b(g)]&&(f["input:"+b(g)]=[]),"select"==g.nodeName.toLowerCase())if("undefined"!==typeof g.multiple){var m=
[];if("undefined"!==typeof g.options)for(var n=0;n<g.options.length;n++)g.options[n].selected&&m.push(g.options[n].value);f["input:"+b(g)].push(m.join(", "))}else f["input:"+b(g)].push(g.options[g.selectedIndex].value);else"input"==g.nodeName.toLowerCase()?"undefined"!==typeof g.type?"checkbox"==g.type.toLowerCase()||"radio"==g.type.toLowerCase()?g.checked&&f["input:"+b(g)].push(g.value):f["input:"+b(g)].push(g.value):f["input:"+b(g)].push(g.value):"textarea"==g.nodeName.toLowerCase()?f["input:"+
b(g)].push(g.value):"undefined"!==typeof g.value&&f["input:"+b(g)].push(g.value);for(var k in f)"undefined"!=typeof f[k].join&&(f[k]=f[k].join(", "));c.add_event({key:"formSubmit",segmentation:f});c.end_session()}})}function e(){if("undefined"!==typeof a.getElementsByTagName)for(var b=a.getElementsByTagName("form"),c=0;c<b.length;c++)f(b[c]);else m("Can't track forms")}a=a||document;"complete"===document.readyState?e():k(window,"load",e)};c.collect_from_forms=function(a,b){function f(f){var e=!1;
k(f,"submit",function(){if(!e){e=!0;var j={},g=!1,d;if("undefined"!==typeof f.elements){var k={},n=a.getElementsByTagName("LABEL"),l;for(l=0;l<n.length;l++)n[l].htmlFor&&""!==n[l].htmlFor&&(k[n[l].htmlFor]=n[l].innerText||n[l].textContent||n[l].innerHTML);for(l=0;l<f.elements.length;l++)if((d=f.elements[l])&&"password"!=d.type&&-1==d.className.indexOf("cly_user_ignore")){var p="";if("select"==d.nodeName.toLowerCase())if("undefined"!==typeof d.multiple){p=[];if("undefined"!==typeof d.options)for(n=
0;n<d.options.length;n++)d.options[n].selected&&p.push(d.options[n].value);p=p.join(", ")}else p=d.options[d.selectedIndex].value;else"input"==d.nodeName.toLowerCase()?"undefined"!==typeof d.type?"checkbox"==d.type.toLowerCase()||"radio"==d.type.toLowerCase()?d.checked&&(p=d.value):p=d.value:p=d.value:"textarea"==d.nodeName.toLowerCase()?p=d.value:"undefined"!==typeof d.value&&(p=d.value);if(d.className&&-1!=d.className.indexOf("cly_user_")){d=d.className.split(" ");for(n=0;n<d.length;n++)if(0===
d[n].indexOf("cly_user_")){j[d[n].replace("cly_user_","")]=p;g=!0;break}}else if(d.type&&"email"==d.type.toLowerCase()||d.name&&-1!=d.name.toLowerCase().indexOf("email")||d.id&&-1!=d.id.toLowerCase().indexOf("email")||d.id&&k[d.id]&&-1!=k[d.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(p))j.email||(j.email=p),g=!0;else if(d.name&&-1!=d.name.toLowerCase().indexOf("username")||d.id&&-1!=d.id.toLowerCase().indexOf("username")||d.id&&k[d.id]&&-1!=k[d.id].toLowerCase().indexOf("username"))j.username||
(j.username=p),g=!0;else if(d.name&&(-1!=d.name.toLowerCase().indexOf("tel")||-1!=d.name.toLowerCase().indexOf("phone")||-1!=d.name.toLowerCase().indexOf("number"))||d.id&&(-1!=d.id.toLowerCase().indexOf("tel")||-1!=d.id.toLowerCase().indexOf("phone")||-1!=d.id.toLowerCase().indexOf("number"))||d.id&&k[d.id]&&(-1!=k[d.id].toLowerCase().indexOf("tel")||-1!=k[d.id].toLowerCase().indexOf("phone")||-1!=k[d.id].toLowerCase().indexOf("number")))j.phone||(j.phone=p),g=!0;else if(d.name&&(-1!=d.name.toLowerCase().indexOf("org")||
-1!=d.name.toLowerCase().indexOf("company"))||d.id&&(-1!=d.id.toLowerCase().indexOf("org")||-1!=d.id.toLowerCase().indexOf("company"))||d.id&&k[d.id]&&(-1!=k[d.id].toLowerCase().indexOf("org")||-1!=k[d.id].toLowerCase().indexOf("company")))j.organization||(j.organization=p),g=!0;else if(d.name&&-1!=d.name.toLowerCase().indexOf("name")||d.id&&-1!=d.id.toLowerCase().indexOf("name")||d.id&&k[d.id]&&-1!=k[d.id].toLowerCase().indexOf("name"))j.name||(j.name=""),j.name+=p+" ",g=!0}}g&&(m("Gathered user data",
j),b?c.user_details({custom:j}):c.user_details(j));c.end_session()}})}function e(){if("undefined"!==typeof a.getElementsByTagName)for(var b=a.getElementsByTagName("form"),c=0;c<b.length;c++)f(b[c]);else m("Can't track forms")}a=a||document;"complete"===document.readyState?e():k(window,"load",e)};c.collect_from_facebook=function(a){FB&&FB.api&&FB.api("/me",function(b){var f={};b.name&&(f.name=b.name);b.email&&(f.email=b.email);"male"==b.gender?f.gender="M":"female"==b.gender&&(f.gender="F");if(b.birthday){var e=
b.birthday.split("/").pop();e&&4==e.length&&(f.byear=e)}b.work&&(b.work[0]&&b.work[0].employer&&b.work[0].employer.name)&&(f.organization=b.work[0].employer.name);if(a){f.custom={};for(var i in a){for(var e=a[i].split("."),h=b,j=0;j<e.length&&!(h=h[e[j]],"undefined"===typeof h);j++);"undefined"!==typeof h&&(f.custom[i]=h)}}c.user_details(f)})};var k=function(a,b,c){"undefined"!==typeof a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},q=function(a,b,c){function e(a,c,b){var e=
new Date;e.setTime(e.getTime()+864E5*b);b="; expires="+e.toGMTString();document.cookie=a+"="+c+b+"; path=/"}var c=c||!1,i=!1,h;if("undefined"!==typeof localStorage){i=!0;try{localStorage.setItem("testLocal",!0)}catch(j){i=!1}}"undefined"!==typeof b&&null!==b&&("object"===typeof b&&(b=JSON.stringify(b)),i?localStorage.setItem(a,b):c||e(a,b,30));if("undefined"===typeof b){if(i)h=localStorage.getItem(a);else if(!c)a:{a+="=";b=document.cookie.split(";");c=0;for(i=b.length;c<i;c++){for(h=b[c];" "===h.charAt(0);)h=
h.substring(1,h.length);if(0===h.indexOf(a)){h=h.substring(a.length,h.length);break a}}h=null}try{h=JSON.parse(h)}catch(g){}return h}null===b&&(i?localStorage.removeItem(a):c||e(a,"",-1))}})(window.Countly=window.Countly||{});
